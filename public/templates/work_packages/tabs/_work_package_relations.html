<div class="relation">
  <h3>
    <accessible-by-keyboard execute="toggleExpand()">
      <i class="icon-pull-content" ng-class="stateClass"></i> {{ title }}
      <span ng-if="!isSingletonRelation">({{ handler.getCount() }})</span>
    </accessible-by-keyboard>
  </h3>
  <div class="content" ng-show="expand">
    <div class="workpackages">
      <div ng-if="handler.relations">
        <table>
          <thead>
            <tr>
              <td>{{ I18n.t('js.work_packages.properties.subject') }}</td>
              <td>{{ I18n.t('js.work_packages.properties.status') }}</td>
              <td>{{ I18n.t('js.work_packages.properties.assignee') }}</td>
              <td></td>
            </tr>
          </thead>
          <tbody>
            <tr related-work-package-table-row
                ng-repeat="relation in handler.relations">
              <td>
                <a title="{{ fullIdentifier }}" class="work_package" ng-class="state" href="{{ workPackagePath(relatedWorkPackage.props.id) }}">
                  {{ fullIdentifier }}
                </a>
              </td>
              <td title="{{ relatedWorkPackage.props.status }}">{{ relatedWorkPackage.props.status }}</td>
              <td>
                <a title="{{ relatedWorkPackage.embedded.assignee.props.name }}" href="{{ userPath(relatedWorkPackage.embedded.assignee.props.id) }}">
                  {{ relatedWorkPackage.embedded.assignee.props.name }}
                </a>
              </td>
              <td><i title="Delete relation"
                     class="delete-item icon-delete"
                     ng-click="removeRelation()"
                     ng-if="canDeleteRelation"></i>
              </td>
            </tr>

          </tbody>
        </table>
      </div>
      <div ng-if="handler.isEmpty()">
        No relation exists
      </div>
    </div>
    <div class="add-relation" ng-if="handler.canAddRelation()">
      <button class="button"
              title="{{ btnTitle }}"
              ng-bind-html="btnIcon + ' ' + btnTitle"
              ng-click="handler.addRelation(this)">
      </button>
      <input id="relation_to_id-{{ handler.relationsId }}"
             name="relation[to_id][{{ handler.relationsId }}]"
             size="10"
             type="text"
             autocomplete="off">
      <div id="related_issue_candidates-{{ handler.relationsId }}"
           class="autocomplete related-issue-candidates"></div>
    </div>
  </div>
</div>
